syntax = "proto3";

package zmk.settings;

// Activity settings (sleep/idle timeouts)
message ActivitySettings {
    // Idle timeout in milliseconds (0 to disable)
    uint32 idle_ms = 1;
    // Sleep timeout in milliseconds (0 to disable)
    uint32 sleep_ms = 2;
    // Source device identifier (0 = central, 1+ = peripheral index)
    // Used to identify which device the settings came from in notifications
    uint32 source = 3;
}

// Request to get activity settings
message GetActivitySettingsRequest {
}

// Response with current activity settings
message GetActivitySettingsResponse {
    ActivitySettings settings = 1;
}

// Request to set activity settings
message SetActivitySettingsRequest {
    ActivitySettings settings = 1;
}

// Response after setting activity settings
message SetActivitySettingsResponse {
    bool success = 1;
}

// Request to get activity settings from all devices (central + peripherals)
message GetAllActivitySettingsRequest {
}

// Response with activity settings from all devices
message GetAllActivitySettingsResponse {
    // Settings from central and all connected peripherals
    repeated ActivitySettings all_settings = 1;
    // True if all devices have the same settings, false if there's a mismatch
    bool in_sync = 2;
}

// Main request message - extensible for future settings
message Request {
    oneof request_type {
        GetActivitySettingsRequest get_activity_settings = 1;
        SetActivitySettingsRequest set_activity_settings = 2;
        GetAllActivitySettingsRequest get_all_activity_settings = 3;
    }
}

// Error response for any failed request
message ErrorResponse {
    string message = 1;
}

// Main response message - extensible for future settings
message Response {
    oneof response_type {
        ErrorResponse error = 1;
        GetActivitySettingsResponse get_activity_settings = 2;
        SetActivitySettingsResponse set_activity_settings = 3;
        GetAllActivitySettingsResponse get_all_activity_settings = 4;
    }
}
